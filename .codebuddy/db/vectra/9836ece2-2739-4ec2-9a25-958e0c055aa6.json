{"chunk":8,"numChunks":11,"fileHash":"VP1tJ+mYvS+jlrJ4+b5WNznDx8FwJyg4TIYztCWrgck=","filePath":"project-board-sync/src/rules/processors/__tests__/assignment-rule.test.js","content":"const { test } = require('node:test');\ntest('PR assigned to monitored user rule', async (t) => {\n    t.beforeEach(() => {\n        // Mock dependencies using require.cache\n        const sharedValidatorPath = require.resolve('../shared-validator');\n        const boardRulesPath = require.resolve('../../../config/board-rules');\n        const logPath = require.resolve('../../../utils/log');\n        require.cache[sharedValidatorPath] = {\n            exports: {\n                validator: {\n                    validateItemCondition: (item, trigger) => {\n                        if (trigger.condition === 'item.assignees.some(assignee => monitored.users.includes(assignee))') {\n                            return item.assignees?.nodes?.some(a => a.login === 'testAssignee');\n                        }\n                        return false;\n                    },\n                    validateSkipRule: (item, skipIf) => {\n                        if (skipIf === \"item.inProject\") {\n                            return item.projectItems?.nodes?.length > 0;\n                        }\n                        return false;\n                    },\n                    steps: {\n                        markStepComplete: (step) => {\n                            // Mock implementation\n                        }\n                    }\n                }\n            }\n        };\n        require.cache[boardRulesPath] = {\n            exports: {\n                loadBoardRules: () => ({\n                    rules: {\n                        board_items: [{\n                            name: \"PullRequest by Assignee\",\n                            description: \"Add pull requests assigned to monitored user\",\n                            trigger: {\n                                type: \"PullRequest\",\n                                condition: \"item.assignees.some(assignee => monitored.users.includes(assignee))\"\n                            },\n                            action: \"add_to_board\",\n                            skip_if: \"item.inProject\"\n                        }]\n                    },\n                    monitoredUsers: ['testAssignee']\n                })\n            }\n        };\n        require.cache[logPath] = {\n            exports: {\n                log: {\n                    info: (msg) => logMessages.push(msg),\n                    debug: (msg) => logMessages.push(msg),\n                    error: (msg) => logMessages"}
{"chunk":10,"numChunks":11,"fileHash":"iryITuluPn/vn6C5euMmHgZJ70l+KgjHugtgCqDKIio=","filePath":"project-board-sync/src/rules/processors/__tests__/repository-rules.test.js","content":"const { test } = require('node:test');\ntest('PR/Issue from monitored repository rule', async (t) => {\n    t.afterEach(() => {\n        // Clear mocks\n        delete require.cache[require.resolve('../shared-validator')];\n        delete require.cache[require.resolve('../../../config/board-rules')];\n        delete require.cache[require.resolve('../../../utils/log')];\n    });\n    await t.test('adds PR to board when from monitored repository', async () => {\n        const pr = {\n            __typename: 'PullRequest',\n            number: 123,\n            repository: { name: 'test-repo' },\n            projectItems: { nodes: [] }  // Not in project\n        };\n\n        const actions = await processBoardItemRules(pr);\n        \n        assert.equal(actions.length, 1);\n        assert.equal(actions[0].action, 'add_to_board');\n        assert.deepEqual(actions[0].params, { item: pr });\n        assert.ok(logMessages.some(msg => msg.includes('Rule Items from Repository triggered for PullRequest #123')));\n    });\n    await t.test('adds Issue to board when from monitored repository', async () => {\n        const issue = {\n            __typename: 'Issue',\n            number: 456,\n            repository: { name: 'test-repo' },\n            projectItems: { nodes: [] }  // Not in project\n        };\n\n        const actions = await processBoardItemRules(issue);\n        \n        assert.equal(actions.length, 1);\n        assert.equal(actions[0].action, 'add_to_board');\n        assert.deepEqual(actions[0].params, { item: issue });\n        assert.ok(logMessages.some(msg => msg.includes('Rule Items from Repository triggered for Issue #456')));\n    });"}
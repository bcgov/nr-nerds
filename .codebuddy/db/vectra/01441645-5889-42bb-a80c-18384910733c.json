{"chunk":10,"numChunks":11,"fileHash":"VP1tJ+mYvS+jlrJ4+b5WNznDx8FwJyg4TIYztCWrgck=","filePath":"project-board-sync/src/rules/processors/__tests__/assignment-rule.test.js","content":"const { test } = require('node:test');\ntest('PR assigned to monitored user rule', async (t) => {\n    t.afterEach(() => {\n        // Clear mocks\n        delete require.cache[require.resolve('../shared-validator')];\n        delete require.cache[require.resolve('../../../config/board-rules')];\n        delete require.cache[require.resolve('../../../utils/log')];\n    });\n    await t.test('adds PR to board when assigned to monitored user', async () => {\n        const pr = {\n            __typename: 'PullRequest',\n            number: 123,\n            assignees: { \n                nodes: [{ login: 'testAssignee' }]\n            },\n            projectItems: { nodes: [] }  // Not in project\n        };\n\n        const actions = await processBoardItemRules(pr);\n        \n        assert.equal(actions.length, 1);\n        assert.equal(actions[0].action, 'add_to_board');\n        assert.deepEqual(actions[0].params, { item: pr });\n        assert.ok(logMessages.some(msg => msg.includes('Rule PullRequest by Assignee triggered for PullRequest #123')));\n    });\n    await t.test('skips PR when already in project', async () => {\n        const pr = {\n            __typename: 'PullRequest',\n            number: 123,\n            assignees: { \n                nodes: [{ login: 'testAssignee' }]\n            },\n            projectItems: { nodes: [{ id: 'some-id' }] }  // Already in project\n        };\n\n        const actions = await processBoardItemRules(pr);\n        \n        assert.equal(actions.length, 0);\n        assert.ok(logMessages.some(msg => msg.includes('Skipping PullRequest #123 - Already in project')));\n    });"}